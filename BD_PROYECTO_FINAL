-----BASE DE DATOS E-Commerce
--Leonardo Rueda Trejo
---Raul Pèrez Atenco
---Christian Gutiérrez Mejia

--------TABLAS----------

DROP TABLE LISTA_PRODUCTOS;
DROP TABLE PEDIDOS;
DROP TABLE PRODUCTOS;
DROP TABLE CLIENTES;

CREATE TABLE CLIENTES (
ID_CLIENTE NUMBER,
NOMBRE VARCHAR2(50) NOT NULL,
APELLIDO VARCHAR2(50) NOT NULL,
EMAIL VARCHAR2(50) NOT NULL,
TELEFONO NUMBER(10,0)NOT NULL,
DIRECCION VARCHAR2(150) NOT NULL,
CONSTRAINT CLIENTE_PK PRIMARY KEY(ID_CLIENTE)
);

CREATE TABLE PRODUCTOS (
ID_PRODUCTO NUMBER,
NOMBRE VARCHAR2(50) NOT NULL,
DESCRIPCION VARCHAR2(150) NOT NULL,
PRECIO NUMBER NOT NULL,
STOCK NUMBER NOT NULL,
CONSTRAINT PRODUCTO_PK PRIMARY KEY(ID_PRODUCTO)
);


CREATE TABLE PEDIDOS (
ID_PEDIDO NUMBER,
CLIENTE NUMBER NOT NULL,
TOTAL NUMBER(10,2) NOT NULL,
FECHA_CREACION  DATE NOT NULL,
ID_ESTADO NUMBER NOT NULL,
CONSTRAINT PEDIDO_PK PRIMARY KEY(ID_PEDIDO),
CONSTRAINT FK_CLIENTE_PEDIDO FOREIGN KEY (CLIENTE)REFERENCES CLIENTES(ID_CLIENTE)
);



CREATE TABLE LISTA_PRODUCTOS(
ID_PEDIDO NUMBER,
ID_PRODUCTO NUMBER,
CONSTRAINT FK_PEDIDO_LISTA_PRODUCTOS FOREIGN KEY (ID_PEDIDO)REFERENCES PEDIDOS(ID_PEDIDO),
CONSTRAINT FK_PRODUCTO_LISTA_PRODUCTOS FOREIGN KEY (ID_PRODUCTO)REFERENCES PRODUCTOS(ID_PRODUCTO)
);




--------SECUENCIAS----------

DROP SEQUENCE SEQ_PEDIDOS;
DROP SEQUENCE SEQ_PRODUCTOS;
DROP SEQUENCE SEQ_CLIENTES;

SECUENCIAS:

CREATE SEQUENCE SEQ_CLIENTES
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;


CREATE SEQUENCE SEQ_PRODUCTOS
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;


CREATE SEQUENCE SEQ_PEDIDOS
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;

-------- ALTERACION DE TABLAS----------

ALTER TABLE CLIENTES
MODIFY ID_CLIENTE DEFAULT SEQ_CLIENTES.NEXTVAL;

ALTER TABLE PRODUCTOS
MODIFY ID_PRODUCTO DEFAULT SEQ_PRODUCTOS.NEXTVAL;

ALTER TABLE PEDIDOS
MODIFY ID_PEDIDO DEFAULT SEQ_PEDIDOS.NEXTVAL;


--------INSERCIONES DE PRUEBA----------

DELETE FROM LISTA_PRODUCTOS;
DELETE FROM PEDIDOS;
DELETE FROM PRODUCTOS;
DELETE FROM CLIENTES;

----CLIENTES---

INSERT INTO CLIENTES VALUES (SEQ_CLIENTES.NEXTVAL, 'Juan', 'Perez', 'correo123@gmail.com', 2463301883, 'Calle Niños Heroes 5');
INSERT INTO CLIENTES VALUES (SEQ_CLIENTES.NEXTVAL, 'Maria', 'Lopez', 'maria.lopez@gmail.com', 5551234567, 'Av. Reforma 123');
INSERT INTO CLIENTES VALUES (SEQ_CLIENTES.NEXTVAL, 'Carlos', 'Gonzalez', 'carlos.gon@gmail.com', 5512345678, 'Calle Hidalgo 45');
INSERT INTO CLIENTES VALUES (SEQ_CLIENTES.NEXTVAL, 'Leonardo', 'SanJuan', 'leonardo.gon@gmail.com', 5512345678, 'Calle Hidalgo 45');

----PRODUCTOS---

INSERT INTO PRODUCTOS VALUES (SEQ_PRODUCTOS.NEXTVAL, 'Laptop', 'Laptop HP 15 pulgadas', 15000, 10);
INSERT INTO PRODUCTOS VALUES (SEQ_PRODUCTOS.NEXTVAL, 'Mouse', 'Mouse inalámbrico Logitech', 500, 50);
INSERT INTO PRODUCTOS VALUES (SEQ_PRODUCTOS.NEXTVAL, 'Teclado', 'Teclado mecánico RGB', 1200, 20);
INSERT INTO PRODUCTOS VALUES (SEQ_PRODUCTOS.NEXTVAL, 'Xbox', 'Teclado mecánico RGB', 12200, 20);
INSERT INTO PRODUCTOS VALUES (SEQ_PRODUCTOS.NEXTVAL, 'Play', 'Teclado mecánico RGB', 12200, 20);

----PEDIDOS---

-- Pedido 1 para cliente 1, estado Pendiente
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 1, 15500.00, TO_DATE('2024-04-21','YYYY-MM-DD'), 1);

-- Pedido 2 para cliente 2, estado Enviado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 2, 500.00, TO_DATE('2024-04-20','YYYY-MM-DD'), 2);

-- Pedido 3 para cliente 3, estado Entregado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 3, 13200.00, TO_DATE('2024-04-19','YYYY-MM-DD'), 3);



-- Pedido 4 para cliente 1, estado Entregado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 1, 24400.00, TO_DATE('2024-04-23','YYYY-MM-DD'), 1);

-- Pedido 5 para cliente 2, estado Enviado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 2, 500.00, TO_DATE('2024-04-20','YYYY-MM-DD'), 2);

-- Pedido 6 para cliente 3, estado Entregado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 3, 13200.00, TO_DATE('2024-04-19','YYYY-MM-DD'), 3);


----LISTA PRODUCTOS---

-- Pedido 1 - cliente 1- incluye Laptop y Mouse - 
INSERT INTO LISTA_PRODUCTOS VALUES (1, 1);
INSERT INTO LISTA_PRODUCTOS VALUES (1, 2);

-- Pedido 2 cliente 2-  incluye solo Mouse - 
INSERT INTO LISTA_PRODUCTOS VALUES (2, 2);


-- Pedido 3 cliente 3 -  incluye Laptop y Teclado - 
INSERT INTO LISTA_PRODUCTOS VALUES (3, 1);
INSERT INTO LISTA_PRODUCTOS VALUES (3, 3);



-- Pedido 4  cliente 1 - incluye xbox y play - 
INSERT INTO LISTA_PRODUCTOS VALUES (4, 4);
INSERT INTO LISTA_PRODUCTOS VALUES (4, 2);

-- Pedido 5  cliente 2 -
INSERT INTO LISTA_PRODUCTOS VALUES (5, 5);
INSERT INTO LISTA_PRODUCTOS VALUES (5, 3);

-- Pedido 6  cliente 3 - 
INSERT INTO LISTA_PRODUCTOS VALUES (6, 2);
INSERT INTO LISTA_PRODUCTOS VALUES (6, 4);


commit;


----EXTRA---

-- Pedido 7 para cliente 1, estado Cancelado
INSERT INTO PEDIDOS VALUES (SEQ_PEDIDOS.NEXTVAL, 1, 24400.00, TO_DATE('2024-04-23','YYYY-MM-DD'), 4);

-- Pedido 7  cliente 1 - incluye xbox y play - 
INSERT INTO LISTA_PRODUCTOS VALUES (7, 2);
INSERT INTO LISTA_PRODUCTOS VALUES (7, 4);
